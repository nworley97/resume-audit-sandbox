{% extends "base.html" %}
{% block content %}

<h3 class="mb-3">Tenants</h3>

<div class="card mb-4 shadow-sm">
  <div class="card-body">
    <h5 class="mb-3">Create a new tenant</h5>
    <form method="post" class="row g-3">
      <div class="col-md-4">
        <label class="form-label">Slug (lowercase / hyphens)</label>
        <input class="form-control" name="slug" placeholder="acme-labs" required pattern="[a-z0-9-]+">
      </div>
      <div class="col-md-4">
        <label class="form-label">Display name (navbar)</label>
        <input class="form-control" name="display_name" placeholder="ACME Labs" required>
      </div>
      <div class="col-md-4">
        <label class="form-label">Logo URL (optional)</label>
        <input class="form-control" name="logo_url" placeholder="https://.../logo.png">
      </div>

      <div class="col-md-4">
        <label class="form-label">Tenant login (username/email)</label>
        <input class="form-control" name="username" placeholder="admin@acme.com" required>
      </div>
      <div class="col-md-4">
        <label class="form-label">Password</label>
        <input class="form-control" type="password" name="password" required>
      </div>
      <div class="col-md-4 d-flex align-items-end">
        <button class="btn btn-primary w-100" type="submit">Create Tenant</button>
      </div>
    </form>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <h5 class="mb-3">Existing tenants</h5>
    <div class="table-responsive">
      <table class="table align-middle">
        <thead>
          <tr>
            <th>Slug</th>
            <th>Display Name</th>
            <th>Logo</th>
            <th>Key Links</th>
          </tr>
        </thead>
        <tbody>
          {% for t in tenants %}
          <tr id="t-{{ t.id }}">
            <td><code>{{ t.slug }}</code></td>
            <td>{{ t.display_name }}</td>
            <td>
              {% if t.logo_url %}
                <img src="{{ t.logo_url }}" alt="logo" style="height:28px" onerror="this.style.display='none'">
              {% else %}-{% endif %}
            </td>
            <td class="small">
              <div><a href="/{{ t.slug }}/login" target="_blank">/{{ t.slug }}/login</a></div>
              <div><a href="/{{ t.slug }}/recruiter" target="_blank">/{{ t.slug }}/recruiter</a></div>
              <div class="text-muted">Jobs: /{{ t.slug }}/apply/&lt;CODE&gt;</div>

              <!-- Minimal inline form: add user -->
              <form class="row g-2 align-items-end mt-2" method="post" action="{{ url_for('super_tenant_add_user', tid=t.id) }}">
                <div class="col-md-4">
                  <input class="form-control form-control-sm" name="username" placeholder="newuser@company.com" required>
                </div>
                <div class="col-md-3">
                  <input class="form-control form-control-sm" type="password" name="password" placeholder="password" required>
                </div>
                <div class="col-md-3">
                  <button class="btn btn-sm btn-outline-primary w-100" type="submit">Add user</button>
                </div>
                <div class="col-md-2 text-end">
                  <a class="btn btn-sm btn-outline-danger w-100" href="{{ url_for('super_tenant_delete_confirm', tid=t.id) }}">Deleteâ€¦</a>
                </div>
              </form>
            </td>
          </tr>
          {% else %}
          <tr><td colspan="4" class="text-muted">No tenants yet.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="mt-3">
  <a class="btn btn-outline-secondary" href="{{ url_for('super_logout') }}">Sign out</a>
</div>

{% endblock %}

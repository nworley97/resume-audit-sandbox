{% extends "base_public.html" %}
{% block title %}Interview Setup{% endblock %}
{% block content %}
<div class="max-w-3xl mx-auto py-12 px-4">
  <div class="text-center mb-8">
    <div class="text-xs text-gray-500">{{ applicant_name }}</div>
    <h1 class="text-xl font-semibold text-gray-900 mt-1">Hi {{ applicant_first or applicant_name }}!</h1>
    <p class="text-gray-700 text-sm mt-1">To help us get to know you better, please answer a few short questions.</p>
    <p class="text-xs text-gray-400">Follow the guidelines below to ensure the best possible experience.</p>
  </div>

  <!-- Tips -->
  <div class="space-y-3">
    <div class="bg-white rounded-xl ring-1 ring-gray-200 p-4">
      <div class="text-xs font-semibold text-gray-900 mb-1">Preparation Tips</div>
      <ul class="text-xs text-gray-600 space-y-1">
        <li>• Stable Internet Connection</li>
        <li>• Quiet Environment</li>
      </ul>
    </div>

    <!-- Camera Access -->
    <div class="bg-white rounded-xl ring-1 ring-gray-200 p-4">
      <div class="text-xs font-semibold text-gray-900 mb-1">Allow Camera Access</div>
      <p class="text-xs text-gray-500 mb-3">To ensure fairness and authenticity for all candidates, please allow access to your camera before starting.</p>

      <div class="flex items-center justify-between">
        <button id="allowCam"
          class="inline-flex items-center rounded-lg bg-blue-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-blue-700">
          Allow camera access
        </button>
        <span id="camStatus" class="text-xs text-gray-500">Camera permission: <span class="font-medium">Pending</span></span>
      </div>
    </div>

    <!-- Policy notice -->
    <div class="bg-white rounded-xl ring-1 ring-gray-200 p-4">
      <p class="text-xs text-gray-600">Failure to answer questions may result in removal from consideration for this role.</p>
    </div>
  </div>

  <div class="text-center mt-8">
    <a href="{{ next_url }}"
       class="inline-flex items-center rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700">
      Start
    </a>
  </div>
</div>

<script>
  const btn = document.getElementById('allowCam');
  const statusEl = document.getElementById('camStatus').querySelector('span');
  if (btn) {
    btn.addEventListener('click', async () => {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        stream.getTracks().forEach(t => t.stop());
        statusEl.textContent = 'Allowed';
        statusEl.classList.add('text-emerald-600');
      } catch (e) {
        statusEl.textContent = 'Blocked';
        statusEl.classList.add('text-rose-600');
      }
    });
  }
</script>
{% endblock %}

{% extends "base_app.html" %}
{% block title %}Recruiter - ALTERA{% endblock %}
{% block content %}

<!-- Page header -->
<div class="flex items-center justify-between mb-6">
  <h1 class="text-xl font-semibold">Job Postings</h1>
  <a href="{{ url_for('edit_jd') }}"
     class="inline-flex items-center rounded-lg bg-primary text-white text-sm font-medium px-4 py-2 hover:bg-blue-600 transition">
    Create Job
  </a>
</div>

<!-- Jobs table -->
<div class="bg-white rounded-xl border border-gray-200 overflow-hidden">
  <table class="min-w-full divide-y divide-gray-200 text-sm">
    <thead class="bg-gray-50">
      <tr class="text-left text-slate">
        <th class="px-4 py-3 font-medium">Job ID</th>
        <th class="px-4 py-3 font-medium">Title</th>
        <th class="px-4 py-3 font-medium">Status</th>
        <th class="px-4 py-3 font-medium">Applicants</th>
        <th class="px-4 py-3 font-medium text-right">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-100">
      {% if jds %}
        {% for jd in jds %}
        <tr class="hover:bg-gray-50">
          <td class="px-4 py-3 text-title whitespace-nowrap">{{ jd.code }}</td>
          <td class="px-4 py-3 text-title">{{ jd.title }}</td>
          <td class="px-4 py-3">
            {% set status = (jd.status or 'draft')|lower %}
            {% if status == 'open' %}
              <span class="inline-flex items-center rounded-full bg-green-50 text-green-700 border border-green-200 px-2.5 py-0.5 text-xs font-medium">Open</span>
            {% elif status == 'closed' %}
              <span class="inline-flex items-center rounded-full bg-gray-100 text-gray-700 border border-gray-200 px-2.5 py-0.5 text-xs font-medium">Closed</span>
            {% else %}
              <span class="inline-flex items-center rounded-full bg-yellow-50 text-yellow-800 border border-yellow-200 px-2.5 py-0.5 text-xs font-medium">Draft</span>
            {% endif %}
          </td>
          <td class="px-4 py-3">
            <span class="inline-flex items-center rounded-md bg-blue-50 text-[#085CFF] border border-blue-100 px-2.5 py-0.5 text-xs font-semibold">
              {{ counts[jd.code] if counts and jd.code in counts else 0 }}
            </span>
          </td>
          <td class="px-4 py-3">
            <div class="flex items-center justify-end gap-2">
              <a href="{{ url_for('view_candidates', code=jd.code) }}"
                 class="inline-flex items-center rounded-md border border-gray-300 px-3 py-1.5 text-xs font-medium text-slate hover:bg-gray-50">
                View Candidates
              </a>
              <a href="{{ url_for('edit_jd') }}?code={{ jd.code }}"
                 class="inline-flex items-center rounded-md border border-gray-300 px-3 py-1.5 text-xs font-medium text-slate hover:bg-gray-50">
                Edit
              </a>
              <a href="{{ url_for('delete_jd', code=jd.code) }}"
                 class="inline-flex items-center rounded-md border border-red-300 text-red-600 px-3 py-1.5 text-xs font-medium hover:bg-red-50"
                 onclick="return confirm('Delete JD?');">
                Delete
              </a>
            </div>
          </td>
        </tr>
        {% endfor %}
      {% else %}
        <tr>
          <td colspan="5" class="px-4 py-6 text-center text-slate">No job postings yet</td>
        </tr>
      {% endif %}
    </tbody>
  </table>
</div>

{% endblock %}

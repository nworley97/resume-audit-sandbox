{% extends "base_app.html" %}
{% block title %}Candidate Detail - ALTERA{% endblock %}

{% block content %}
<div class="space-y-6">
  <!-- Breadcrumb -->
  <nav class="text-sm text-gray-500">
    <a href="{{ url_for('candidates_overview', tenant=tenant.slug) }}" class="hover:underline">Recruiter</a> /
    <a href="{{ url_for('candidates_overview', tenant=tenant.slug) }}" class="hover:underline">Candidates</a> /
    <span class="text-gray-700 font-medium">{{ c.first_name }} {{ c.last_name }}</span>
  </nav>

  <!-- Candidate Header -->
  <div>
    <h1 class="text-2xl font-bold text-gray-900">{{ c.first_name }} {{ c.last_name }}</h1>
    <p class="text-gray-600">
      Candidate /
      {{ jd.title if jd else c.job_title }}
    </p>
  </div>

  <!-- Score Chips -->
  <div class="flex gap-2">
    <span class="inline-flex items-center rounded-full px-3 py-1 text-sm font-medium
      {% if c.relevancy >= REL_GREEN %} bg-green-100 text-green-700
      {% elif c.relevancy >= REL_YELLOW %} bg-yellow-100 text-yellow-700
      {% else %} bg-red-100 text-red-700 {% endif %}">
      Relevancy: {{ "%.1f"|format relevancy or 0) }}
    </span>
    <span class="inline-flex items-center rounded-full px-3 py-1 text-sm font-medium
      {% if claim_validity >= SCORE_GREEN %} bg-green-100 text-green-700
      {% elif claim_validity >= SCORE_YELLOW %} bg-yellow-100 text-yellow-700
      {% else %} bg-red-100 text-red-700 {% endif %}">
      Claim Validity: {{ "%.1f"|format(claim_validity or 0) }}
    </span>
  </div>

  <!-- Resume Card -->
  <div class="bg-white shadow-sm ring-1 ring-gray-200 rounded-xl p-4 space-y-4">
    <div class="flex justify-between items-center">
      <h2 class="text-lg font-semibold text-gray-900">Resume</h2>
      <div class="flex gap-2">
        {% if resume_url %}
        <a href="{{ resume_url }}" target="_blank"
           class="inline-flex items-center rounded-lg bg-blue-600 px-3 py-2 text-sm font-semibold text-white hover:bg-blue-700">
          Download Resume PDF
        </a>
        {% endif %}
        <a href="{{ url_for('delete_candidate', tenant=tenant.slug, cid=c.id) }}"
           class="inline-flex items-center rounded-lg bg-red-100 px-3 py-2 text-sm font-semibold text-red-700 hover:bg-red-200">
          Delete Candidate
        </a>
      </div>
    </div>

    <div class="border rounded-lg bg-gray-50 h-[600px] flex items-center justify-center">
      {% if resume_url %}
        <iframe src="{{ resume_url }}" class="w-full h-full border-0 rounded-lg" title="Resume PDF Preview"></iframe>
      {% else %}
        <div class="text-center text-gray-500">
          <p class="font-medium">Resume Preview</p>
          <p class="text-sm">PDF preview placeholder</p>
        </div>
      {% endif %}
    </div>
  </div>

  <!-- AI Q&A Assessment -->
  <div class="bg-white shadow-sm ring-1 ring-gray-200 rounded-xl p-4">
    <h2 class="text-lg font-semibold text-gray-900">AI Q&amp;A Assessment</h2>
    <div class="mt-4 divide-y divide-gray-200">
      {% if answers %}
        {% for qa in answers %}
          <div class="py-3">
            <p class="font-medium text-gray-900">{{ loop.index }}. {{ qa.question }}</p>
            <p class="mt-1 text-gray-700">{{ qa.answer }}</p>
          </div>
        {% endfor %}
      {% else %}
        <p class="py-4 text-gray-500">No AI questions available for this candidate.</p>
      {% endif %}
    </div>
  </div>

  <!-- Back Button -->
  <div>
    <a href="{{ url_for('candidates_overview', tenant=tenant.slug) }}"
       class="inline-flex items-center rounded-md border px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">
      ‚Üê Back to Candidates
    </a>
  </div>
</div>
{% endblock %}

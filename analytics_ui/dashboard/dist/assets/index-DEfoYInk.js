import{r as b,j as e,S as oe,I as ve,H as ye,T as le,C as ce,b as je,c as Ne,d as we,P as _e,e as Se,f as ke,V as Ce,g as Ae,h as Re,i as Ee,R as Ie}from"../js/ui-vendor-BxJI-E__.js";import{a as Le,g as Fe}from"../js/react-vendor-Dazix4UH.js";import{c as $e,u as de,Q as Te,a as ze}from"../js/state-vendor-BbuYJZ1I.js";import{u as ue,L as Be,a as me,B as De}from"../js/router-vendor-BLH-YP3L.js";import{L as Me,U as Pe,C as Ue,A as Oe,a as Ve,F as Je,R as qe,D as He,S as q,b as We,c as Qe,d as Ye,e as Ke}from"../js/icons-vendor-1vZNkTbT.js";import{t as Xe,c as Ge,a as xe}from"../js/utils-vendor-CjxovF-h.js";import{o as v,n as m,s as p,a as E,b as fe}from"../js/form-vendor-lHSFF-FT.js";import{m as H}from"../js/animation-vendor--u6KOL6c.js";import{o as Ze,X as et}from"../js/charts-vendor-DmXDY7sF.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var U={},se;function tt(){if(se)return U;se=1;var t=Le();return U.createRoot=t.createRoot,U.hydrateRoot=t.hydrateRoot,U}var st=tt();const rt=Fe(st);var at=function(){return null};const nt=[{label:"Job Posting",href:t=>`/${t}/recruiter`,icon:Me},{label:"Candidates",href:t=>`/${t}/recruiter/candidates`,icon:Pe},{label:"Analytics",href:t=>`/${t}/recruiter/analytics`,icon:Ue}];function it(t){return t.split(" ").filter(Boolean).map(r=>r[0]?.toUpperCase()??"").join("").slice(0,2)||"AL"}function re({tenant:t,children:s}){const a=ue().pathname,n=()=>typeof window>"u"?!1:window.innerWidth<1024,[i,l]=b.useState(()=>{if(typeof window>"u")return!1;try{const d=window.localStorage?.getItem("app-sidebar-collapsed");return n()?!0:d!==null?d==="1":!1}catch{return n()}}),[o,f]=b.useState(null),[g,_]=b.useState(!1),[R,S]=b.useState(!1),[u,x]=b.useState(!1),[c,k]=b.useState("JD"),[y,h]=b.useState(!1),j=b.useMemo(()=>{if(o?.display_name)return o.display_name;const d=t.replace(/[-_]+/g," ").trim();return d?d.replace(/\b\w/g,w=>w.toUpperCase()):"Altera"},[t,o?.display_name]),L=it(j);b.useEffect(()=>{let d=!1;f(null),_(!1),S(!1),x(!1);async function w(){try{const C=await fetch(`/api/tenants/${encodeURIComponent(t)}/metadata`,{credentials:"include",headers:{Accept:"application/json"}});if(!C.ok)return;const F=await C.json();d||f(F)}catch{}finally{d||_(!0)}}return w(),()=>{d=!0}},[t]),b.useEffect(()=>{S(!1),x(!1)},[o?.logo_url]),b.useEffect(()=>{if(typeof window>"u")return;const d=window.localStorage?.getItem("analytics-user-initials");d&&(k(d.slice(0,2).toUpperCase()),h(!0))},[]),b.useEffect(()=>{let d=!1;async function w(){try{const C=await fetch("/api/session/me",{credentials:"include",headers:{Accept:"application/json"}});if(!C.ok)return;const F=await C.json();if(!d){const z=(F.initials||F.username||"JD").slice(0,2).toUpperCase();if(k(z),typeof window<"u")try{window.localStorage?.setItem("analytics-user-initials",z)}catch{}}}catch{}finally{d||h(!0)}}return w(),()=>{d=!0}},[]),b.useEffect(()=>{if(!(typeof document>"u")){document.body.classList.toggle("sidebar-collapsed",i);try{window.localStorage?.setItem("app-sidebar-collapsed",i?"1":"0")}catch{}}},[i]),b.useEffect(()=>{if(typeof window>"u")return;let d,w=!1;const C=()=>{w||(w=!0,clearTimeout(d),d=setTimeout(()=>{if(n())l(!0);else if(i){l(!1);try{localStorage.setItem("app-sidebar-collapsed","0")}catch{}}w=!1},200))};return window.addEventListener("resize",C),()=>{clearTimeout(d),window.removeEventListener("resize",C)}},[i]);const T=()=>{l(d=>!d)},B=e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",className:"h-4 w-4",children:[e.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2"}),e.jsx("rect",{x:"6",y:"8",width:"5",height:"8",rx:"1"})]}),Y=e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",className:"h-4 w-4",children:[e.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2"}),e.jsx("rect",{x:"13",y:"8",width:"5",height:"8",rx:"1"})]});return e.jsxs("div",{className:"min-h-screen flex bg-white text-slate-900",children:[e.jsxs("aside",{className:`bg-white border-r border-gray-200 relative transition-all duration-300 ease-out overflow-hidden ${i?"w-[4.5rem]":"w-56"}`,children:[e.jsxs("div",{className:`flex items-center gap-2 py-4 px-4 transition-all duration-200 ${i?"justify-center":""}`,children:[e.jsx("div",{className:"flex h-10 w-10 flex-shrink-0 items-center justify-center",children:e.jsx("div",{className:"relative h-10 w-10 rounded-full overflow-hidden flex items-center justify-center bg-gray-900 text-white text-xs",children:g?o?.logo_url&&!u?e.jsxs(e.Fragment,{children:[R?null:e.jsx("div",{className:"absolute inset-0 animate-pulse bg-gray-200","aria-hidden":!0}),e.jsx("img",{src:o.logo_url,alt:`${j} logo`,className:`h-full w-full object-cover transition-opacity duration-200 ${R?"opacity-100":"opacity-0"}`,onLoad:()=>S(!0),onError:()=>{x(!0),S(!1)}})]}):e.jsx("span",{children:L}):e.jsx("div",{className:"h-full w-full animate-pulse bg-gray-200","aria-hidden":!0})})}),!i&&e.jsx("div",{className:"min-w-0 flex items-center",children:g?e.jsx("span",{className:"text-sm font-medium text-slate-900 leading-tight truncate max-w-[9rem]",children:j}):e.jsx("div",{className:"h-4 w-24 rounded bg-gray-200 animate-pulse","aria-hidden":!0})})]}),e.jsx("nav",{className:"px-2",children:nt.map(({label:d,href:w,icon:C},F)=>{const z=w(t);let K=!1;d==="Job Posting"?K=a===z:K=a===z||a.startsWith(`${z}/`);const te=[F>0?"mt-1":"","flex items-center rounded-lg text-sm transition py-2",i?"justify-center px-2":"gap-2 px-3",K?"bg-primary/10 text-primary":"text-slate-900 hover:bg-gray-50"].filter(Boolean).join(" ");return d==="Analytics"?e.jsxs(Be,{to:z,className:te,"aria-label":d,children:[e.jsx(C,{className:"w-4 h-4","aria-hidden":!0}),!i&&e.jsx("span",{children:d})]},d):e.jsxs("a",{href:z,className:te,"aria-label":d,children:[e.jsx(C,{className:"w-4 h-4","aria-hidden":!0}),!i&&e.jsx("span",{children:d})]},d)})}),e.jsxs("div",{className:`absolute bottom-4 flex items-center text-xs text-slate-500 leading-4 ${i?"left-1/2 -translate-x-1/2 flex-col gap-1 text-center":"left-2 gap-1.5 justify-start px-3"}`,children:[e.jsx("img",{src:"/favicon-32x32.png",alt:"Altera mark",width:16,height:16,className:"rounded"}),!i&&e.jsx("a",{href:"https://alterasf.com/",target:"_blank",rel:"noopener noreferrer",className:"hover:text-slate-700 hover:underline cursor-pointer transition-colors duration-200",children:"Powered by AlteraSF"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("header",{className:"w-full bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{type:"button",onClick:T,className:"sidebar-toggle inline-flex items-center justify-center bg-white text-slate-700 px-3 py-2 rounded-lg hover:bg-[#EAEAEA] transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-primary/60","aria-label":"Toggle navigation","aria-pressed":i?"true":"false",children:i?Y:B})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("a",{href:"/logout",className:"inline-flex items-center rounded-lg border border-gray-300 px-3 py-1.5 text-sm hover:bg-gray-50",children:"Sign out"}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-900 text-white text-xs flex items-center justify-center",children:y?e.jsx("span",{children:c}):e.jsx("div",{className:"h-4 w-4 animate-pulse bg-gray-200 rounded","aria-hidden":!0})})]})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:s})]})]})}function N(...t){return Xe(Ge(t))}function A(t){const s=typeof t=="string"?Number(t):t??0,r=Number.isFinite(s)?s:0;return new Intl.NumberFormat().format(r)}const ot=xe("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function $({className:t,variant:s,asChild:r=!1,...a}){const n=r?oe:"span";return e.jsx(n,{"data-slot":"badge",className:N(ot({variant:s}),t),...a})}const lt=xe("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function D({className:t,variant:s,size:r,asChild:a=!1,...n}){const i=a?oe:"button";return e.jsx(i,{"data-slot":"button",className:N(lt({variant:s,size:r,className:t})),...n})}function M({className:t,...s}){return e.jsx("div",{"data-slot":"card",className:N("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function W({className:t,...s}){return e.jsx("div",{"data-slot":"card-header",className:N("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function Q({className:t,...s}){return e.jsx("div",{"data-slot":"card-title",className:N("leading-none font-semibold",t),...s})}function ct({className:t,...s}){return e.jsx("div",{"data-slot":"card-description",className:N("text-muted-foreground text-sm",t),...s})}function P({className:t,...s}){return e.jsx("div",{"data-slot":"card-content",className:N("px-6",t),...s})}function I({className:t,...s}){return e.jsx("div",{"data-slot":"skeleton",className:N("bg-[#F2F1EE] animate-pulse rounded-md",t),...s})}const dt={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var ut={};const mt=typeof import.meta<"u"?dt:{},xt=typeof process<"u"?ut:{};function he(t){for(const s of t){const r=mt?.[s];if(typeof r=="string"&&r.length>0)return r;const a=xt?.[s];if(typeof a=="string"&&a.length>0)return a}}const ae=he(["VITE_ANALYTICS_API_BASE","NEXT_PUBLIC_ANALYTICS_API_BASE"])?.trim(),ft=ae?ae.replace(/\/$/,""):"",ht=he(["VITE_ANALYTICS_TENANT","NEXT_PUBLIC_ANALYTICS_TENANT"]),Z={analyticsBaseUrl:ft,defaultTenant:ht||void 0},pt=v({jd_code:p(),jd_title:p().nullable().optional(),status:p().nullable().optional(),department:p().nullable().optional(),team:p().nullable().optional(),posted:p().nullable().optional(),applicants:m(),diamonds_found:m()}),ne=v({mean:m().nullable(),median:m().nullable(),std_dev:m().nullable()}),gt=E(v({stage:p(),count:m(),percentage:m()})),bt=v({id:p(),name:p(),initials:p(),claim_validity_score:m(),relevancy_score:m(),combined_score:m()}),vt=v({index:m(),label:p(),value:m().nullable(),is_no_score:fe()}),yt=v({index:m(),label:p(),bucket:m(),is_no_score:fe()}),jt=v({relevancy:m(),claim:m(),candidates:E(v({id:p(),name:p(),initials:p(),claim_validity_score:m(),relevancy_score:m()}))}),Nt=v({jd:v({code:p(),title:p().nullable().optional(),status:p().nullable().optional(),department:p().nullable().optional(),team:p().nullable().optional(),posted:p().nullable().optional()}),totals:v({applied:m(),diamonds_found:m(),completion_pct:m(),completed:m()}),heatmap:v({matrix:E(E(m())),axes:v({relevancy:E(vt),claim_validity:E(yt)}),cells:E(jt)}),distributions:v({claim_validity:E(m()),relevancy:E(m())}),summary:v({total_candidates:m(),diamonds_found:m(),completion_rate:m(),last_updated:p()}),diamonds:E(bt),completion_funnel:gt,roi:v({variables:v({total_applicants:m(),diamonds_count:m(),manual_time_per_applicant:m(),assisted_time_per_applicant:m(),hourly_rate:m()}),calculated:v({time_saved_hours:m(),cost_saved:m(),speed_improvement:m().nullable(),efficiency_percentage:m()})}),statistics:v({claim_validity:ne,relevancy:ne})}),wt=E(pt);function pe(t,s){const r=(Z.analyticsBaseUrl||"").trim(),a=r.length>0,n=typeof window<"u"?window.location.origin:"http://localhost",i=a?r.endsWith("/")?r:`${r}/`:`${n}/`,l=a?t.replace(/^\/+/,""):t.startsWith("/")?t:`/${t}`,o=new URL(l,i);return s&&o.searchParams.set("tenant",s),o.toString()}async function ge(t,s){const r=await fetch(t,{...s,headers:{"Content-Type":"application/json"},cache:"no-store"});if(!r.ok){const a=await r.text();throw new Error(`Request failed (${r.status}): ${a||r.statusText}`)}return await r.json()}async function _t(t){const s=await ge(pe("/analytics/summary",t));return wt.parse(s)}async function St(t,s){const r=await ge(pe(`/analytics/job/${encodeURIComponent(t)}`,s));return Nt.parse(r)}function kt(t,s){let r;try{r=t()}catch{return}return{getItem:n=>{var i;const l=f=>f===null?null:JSON.parse(f,void 0),o=(i=r.getItem(n))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(n,i)=>r.setItem(n,JSON.stringify(i,void 0)),removeItem:n=>r.removeItem(n)}}const G=t=>s=>{try{const r=t(s);return r instanceof Promise?r:{then(a){return G(a)(r)},catch(a){return this}}}catch(r){return{then(a){return this},catch(a){return G(a)(r)}}}},Ct=(t,s)=>(r,a,n)=>{let i={storage:kt(()=>localStorage),partialize:c=>c,version:0,merge:(c,k)=>({...k,...c}),...s},l=!1;const o=new Set,f=new Set;let g=i.storage;if(!g)return t((...c)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...c)},a,n);const _=()=>{const c=i.partialize({...a()});return g.setItem(i.name,{state:c,version:i.version})},R=n.setState;n.setState=(c,k)=>(R(c,k),_());const S=t((...c)=>(r(...c),_()),a,n);n.getInitialState=()=>S;let u;const x=()=>{var c,k;if(!g)return;l=!1,o.forEach(h=>{var j;return h((j=a())!=null?j:S)});const y=((k=i.onRehydrateStorage)==null?void 0:k.call(i,(c=a())!=null?c:S))||void 0;return G(g.getItem.bind(g))(i.name).then(h=>{if(h)if(typeof h.version=="number"&&h.version!==i.version){if(i.migrate){const j=i.migrate(h.state,h.version);return j instanceof Promise?j.then(L=>[!0,L]):[!0,j]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,h.state];return[!1,void 0]}).then(h=>{var j;const[L,T]=h;if(u=i.merge(T,(j=a())!=null?j:S),r(u,!0),L)return _()}).then(()=>{y?.(u,void 0),u=a(),l=!0,f.forEach(h=>h(u))}).catch(h=>{y?.(void 0,h)})};return n.persist={setOptions:c=>{i={...i,...c},c.storage&&(g=c.storage)},clearStorage:()=>{g?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>l,onHydrate:c=>(o.add(c),()=>{o.delete(c)}),onFinishHydration:c=>(f.add(c),()=>{f.delete(c)})},i.skipHydration||x(),u||S},At=Ct,ee=$e()(At(t=>({tenant:Z.defaultTenant,selectedJobCode:void 0,setTenant:s=>t({tenant:s}),setSelectedJob:s=>t({selectedJobCode:s})}),{name:"analytics-preferences",version:1}));function be({title:t,subtitle:s,breadcrumbLabel:r,breadcrumbHref:a,showBackButton:n=!1,onBackClick:i,showRefreshButton:l=!1,onRefreshClick:o,showExportButton:f=!1,onExportClick:g,showDateRange:_=!1,dateRange:R,onDateRangeClick:S,showFilters:u=!1,onFiltersClick:x,className:c}){return e.jsx("div",{className:N("sticky top-0 z-40 w-full border-b border-border/60 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",c),children:e.jsxs("div",{className:"px-6 py-3",children:[n&&e.jsx("div",{className:"mb-2",children:e.jsx(D,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-[#F2F1EE] cursor-pointer",children:e.jsx(Oe,{className:"size-4"})})}),r&&e.jsx("div",{className:"mb-2",children:a?e.jsxs("a",{href:a,className:"inline-flex items-center gap-[6px] text-sm text-muted-foreground hover:text-foreground cursor-pointer","aria-label":r,children:[e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("path",{d:"M5 21v-6"}),e.jsx("path",{d:"M12 21V3"}),e.jsx("path",{d:"M19 21V9"})]}),e.jsx("span",{children:r})]}):e.jsxs("div",{className:"inline-flex items-center gap-[6px] text-sm text-muted-foreground",children:[e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("path",{d:"M5 21v-6"}),e.jsx("path",{d:"M12 21V3"}),e.jsx("path",{d:"M19 21V9"})]}),e.jsx("span",{children:r})]})}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-[24px] leading-7 font-semibold text-foreground",style:{fontFamily:"var(--font-heading), var(--font-sans)"},children:t}),s&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[_&&e.jsxs(D,{variant:"outline",size:"sm",onClick:S,className:"h-8 gap-2 hover:bg-[#F2F1EE] cursor-pointer",children:[e.jsx(Ve,{className:"size-4"}),R||"Last 30 days"]}),u&&e.jsxs(D,{variant:"outline",size:"sm",onClick:x,className:"h-8 gap-2 hover:bg-[#F2F1EE] cursor-pointer",children:[e.jsx(Je,{className:"size-4"}),"Filters"]}),l&&e.jsxs(D,{variant:"outline",size:"sm",onClick:o,className:"h-8 gap-2 hover:bg-[#F2F1EE] cursor-pointer",children:[e.jsx(qe,{className:"size-4"}),"Refresh"]}),f&&e.jsxs(D,{variant:"outline",size:"sm",onClick:g,className:"h-8 gap-2 hover:bg-[#F2F1EE] cursor-pointer",children:[e.jsx(He,{className:"size-4"}),"Export"]})]})]})]})})}function Rt(t){if(!t)return e.jsx($,{variant:"outline",className:"text-xs",children:"Draft"});const s=t.toLowerCase();return s==="open"?e.jsx($,{className:"bg-blue-500/15 text-blue-600 hover:bg-blue-500/25 text-xs",children:"Open"}):s==="closed"?e.jsx($,{className:"bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs",children:"Closed"}):e.jsx($,{variant:"outline",className:"text-xs",children:t})}function Et({job:t,index:s,tenant:r}){const a=me(),{setSelectedJob:n}=ee();return e.jsx(H.article,{layout:!0,initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:s*.05},children:e.jsx(M,{className:"group overflow-hidden rounded-2xl border border-border/40 bg-card/95 shadow-sm transition-all duration-200 hover:-translate-y-1 hover:shadow-lg hover:border-brand/20 hover:shadow-brand/10",children:e.jsxs("button",{type:"button",onClick:()=>{n(t.jd_code),a(`/${r}/recruiter/analytics/${t.jd_code}`)},className:"flex h-full w-full flex-col items-stretch text-left focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","aria-label":`View analytics for ${t.jd_title||t.jd_code}`,children:[e.jsxs(W,{className:"gap-0 space-y-0 p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-1",children:[e.jsx(Q,{className:"text-base font-semibold text-foreground break-words flex-1",children:t.jd_title||t.jd_code}),e.jsx("div",{className:"flex-shrink-0",children:Rt(t.status)})]}),t.department&&e.jsx("p",{className:"text-xs text-muted-foreground break-words",children:t.department}),t.team&&e.jsx("p",{className:"text-xs text-muted-foreground break-words",children:t.team})]}),e.jsx("div",{className:"px-5",children:e.jsx("div",{className:"h-px bg-border/60"})}),e.jsx(P,{className:"flex flex-1 flex-col gap-2 p-5",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Applicants"}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:A(t.applicants)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Diamonds Found"}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:A(t.diamonds_found)})]})]})})]})})})}function It({index:t}){return e.jsxs(H.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:t*.05},className:"rounded-2xl border border-border/50 bg-muted/40 p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-1",children:[e.jsx(I,{className:"h-5 w-40 rounded-lg flex-1"}),e.jsx(I,{className:"h-5 w-14 rounded-md flex-shrink-0"})]}),e.jsx(I,{className:"h-3 w-32 mb-1"}),e.jsx(I,{className:"h-3 w-24 mb-4"}),e.jsx("div",{className:"h-px bg-border/60 mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{className:"h-3 w-20"}),e.jsx(I,{className:"h-4 w-12"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{className:"h-3 w-28"}),e.jsx(I,{className:"h-4 w-8"})]})]})]})}function Lt({tenant:t}){const{setTenant:s}=ee();b.useEffect(()=>{s(t)},[s,t]);const{data:r,isLoading:a,isError:n,refetch:i}=de({queryKey:["analytics-summary",t],queryFn:()=>_t(t),enabled:!!t}),l=!!r&&r.length>0;return t?e.jsxs("div",{className:"space-y-0",children:[e.jsx(be,{title:"Analytics Dashboard",subtitle:"Select a job posting to view detailed analytics",breadcrumbLabel:"Analytics",showRefreshButton:!1,onRefreshClick:()=>window.location.reload()}),e.jsxs("section",{className:"bg-white p-6",children:[n?e.jsxs(M,{className:"rounded-2xl border-destructive/50 bg-destructive/5 p-6",children:[e.jsx(W,{className:"p-0",children:e.jsx(Q,{className:"text-base text-destructive",children:"Unable to load analytics summary"})}),e.jsxs(P,{className:"mt-2 space-y-4 p-0 text-sm text-destructive/80",children:[e.jsx("p",{children:"Check that the analytics microservice is running on port 5055."}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>i(),children:"Retry"})]})]}):null,e.jsxs("div",{className:"grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4",children:[a?Array.from({length:3}).map((o,f)=>e.jsx(It,{index:f},`skeleton-${f}`)):null,!a&&l?r?.map((o,f)=>e.jsx(Et,{job:o,index:f,tenant:t},o.jd_code)):null]}),!a&&!l&&!n?e.jsx(M,{className:"rounded-2xl border-dashed border-border/70 bg-muted/40 p-10 text-center",children:e.jsxs(P,{className:"space-y-3 p-0",children:[e.jsx(q,{className:"mx-auto size-10 text-primary"}),e.jsx("p",{className:"text-lg font-semibold text-foreground",children:"No analytics yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create a job posting and invite candidates to unlock the analytics dashboard."})]})}):null]})]}):e.jsx(M,{className:"rounded-2xl border-border/60 bg-muted/40 p-10 text-center",children:e.jsxs(P,{className:"space-y-3 p-0",children:[e.jsx(q,{className:"mx-auto size-10 text-primary"}),e.jsx("p",{className:"text-lg font-semibold text-foreground",children:"Select a tenant"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Provide a tenant slug in the URL, e.g. /acme/analytics, to load analytics data."})]})})}const Ft=je,O=b.forwardRef(({className:t,...s},r)=>e.jsx(ve,{ref:r,className:N("border-b",t),...s}));O.displayName="AccordionItem";const V=b.forwardRef(({className:t,children:s,...r},a)=>e.jsx(ye,{className:"flex",children:e.jsxs(le,{ref:a,className:N("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...r,children:[s,e.jsx(We,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));V.displayName=le.displayName;const J=b.forwardRef(({className:t,children:s,...r},a)=>e.jsx(ce,{ref:a,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:e.jsx("div",{className:N("pb-4 pt-0",t),children:s})}));J.displayName=ce.displayName;function $t({data:t,completionRate:s,onOverallConversion:r}){if(!t||!Array.isArray(t)||t.length===0)return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Verification Funnel"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Track candidate progress across the verification journey"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:"0.0%"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Overall Conversion"})]})]}),e.jsx("div",{className:"h-48 flex flex-col items-center justify-center text-muted-foreground space-y-2",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-medium text-foreground mb-1",children:"Waiting for candidates"}),e.jsxs("div",{className:"text-sm",children:["Verification progress will appear here",e.jsx("br",{}),"once candidates start the process"]})]})})]});const a=t.map(o=>({id:o.stage,value:o.count,label:o.stage})),n=t[0]?.count||0,i=t[t.length-1]?.count||0,l=n>0?i/n*100:0;return typeof r=="function"&&r(l),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Verification Funnel"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Track candidate progress across the verification journey"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[l.toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Overall Conversion"})]})]}),e.jsx("div",{className:"h-48",children:e.jsx(Ze,{data:a,margin:{top:20,right:20,bottom:20,left:20},valueFormat:">-.0f",colors:{scheme:"blues"},borderWidth:1,borderColor:{from:"color",modifiers:[["darker",.3]]},labelColor:{from:"color",modifiers:[["darker",1]]},beforeSeparatorLength:100,beforeSeparatorOffset:20,afterSeparatorLength:100,afterSeparatorOffset:20,currentPartSizeExtension:10,currentBorderWidth:40,motionConfig:"wobbly",direction:"horizontal",theme:{text:{fontSize:12,fill:"var(--foreground)"},tooltip:{container:{background:"var(--card)",color:"var(--card-foreground)",fontSize:12,borderRadius:6,boxShadow:"0 3px 9px rgba(0, 0, 0, 0.5)",border:"1px solid var(--border)"}}},tooltip:({part:o})=>e.jsxs("div",{className:"rounded-md border border-border bg-card px-3 py-2 text-sm text-card-foreground shadow-md",children:[e.jsx("div",{className:"font-medium",children:o.data.label}),e.jsxs("div",{className:"text-muted-foreground",children:[A(o.data.value)," candidates (",t[0]?.count?Math.round(o.data.value/t[0].count*100):0,"%)"]})]})})}),e.jsx("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:t.map((o,f)=>{const g=f>0?t[f-1]?.count||0:o.count||0,_=g>0?Math.round((o.count||0)/g*100):100;return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-foreground",children:o.stage}),e.jsx("div",{className:"text-primary font-semibold",children:A(o.count||0)}),e.jsxs("div",{children:[_,"% pass"]})]},o.stage)})})]})}function Tt({...t}){return e.jsx(Ne,{"data-slot":"popover",...t})}function zt({...t}){return e.jsx(we,{"data-slot":"popover-trigger",...t})}function Bt({className:t,align:s="center",sideOffset:r=4,...a}){return e.jsx(_e,{children:e.jsx(Se,{"data-slot":"popover-content",align:s,sideOffset:r,className:N("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-sm border p-4 shadow-md outline-hidden",t),...a})})}function Dt({className:t,children:s,...r}){return e.jsxs(ke,{"data-slot":"scroll-area",className:N("relative",t),...r,children:[e.jsx(Ce,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:s}),e.jsx(Mt,{}),e.jsx(Ae,{})]})}function Mt({className:t,orientation:s="vertical",...r}){return e.jsx(Re,{"data-slot":"scroll-area-scrollbar",orientation:s,className:N("flex touch-none p-px transition-colors select-none",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",t),...r,children:e.jsx(Ee,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Pt(t,s){if(typeof t=="number"){const r=t===0;return{index:s,label:r?"No Score":`${t}/5`,value:t,isNoScore:r}}if(t&&typeof t=="object"){const r=t,a=typeof r.value=="number"?r.value:typeof r.bucket=="number"?r.bucket:null,n=typeof r.label=="string"?r.label:a!==null?`${a}/5`:`Range ${r.index??s}`,i=!!(r.is_no_score??n.toLowerCase().includes("no score")??a===0);return{index:typeof r.index=="number"?r.index:s,label:n,value:a,isNoScore:i}}return{index:s,label:`Range ${s}`,value:null,isNoScore:!0}}function Ut(t,s){if(typeof t=="number"){const r=t===0;return{index:s,label:r?"No Score":`Claim ${t}`,bucket:t,isNoScore:r}}if(t&&typeof t=="object"){const r=t,a=typeof r.bucket=="number"?r.bucket:typeof r.value=="number"?r.value:null,n=typeof r.label=="string"?r.label:a!==null?`Claim ${a}`:`Bucket ${r.index??s}`,i=!!(r.is_no_score??n.toLowerCase().includes("no score")??a===0);return{index:typeof r.index=="number"?r.index:s,label:n,bucket:a,isNoScore:i}}return{index:s,label:`Bucket ${s}`,bucket:null,isNoScore:!0}}function Ot({detail:t,tenant:s}){const r=u=>Number.isFinite(u)?u.toFixed(1):"0.0";if(!t?.heatmap?.matrix)return e.jsx(M,{className:"rounded-3xl border-border/60 bg-card/95",children:e.jsxs(W,{className:"p-6",children:[e.jsx(Q,{children:"Cross Validation Matrix"}),e.jsx(ct,{children:"No heatmap data available"})]})});const a=t.totals?.applied||0,l=[...(t.heatmap.axes?.claim_validity??[]).map(Ut)].sort((u,x)=>u.isNoScore&&x.isNoScore?0:u.isNoScore?1:x.isNoScore?-1:(x.bucket??-1/0)-(u.bucket??-1/0)),g=[...(t.heatmap.axes?.relevancy??[]).map(Pt)].sort((u,x)=>u.isNoScore&&x.isNoScore?0:u.isNoScore?1:x.isNoScore?-1:(x.value??-1/0)-(u.value??-1/0)),_=new Map;t.heatmap?.cells&&t.heatmap.cells.forEach(u=>{const x=u.candidates?.map(c=>({...c,claim_validity_score:Number.isFinite(c.claim_validity_score)?Number(c.claim_validity_score):typeof c.claim_validity_score=="number"?c.claim_validity_score:0,relevancy_score:Number.isFinite(c.relevancy_score)?Number(c.relevancy_score):typeof c.relevancy_score=="number"?c.relevancy_score:0}))??[];_.set(`${u.relevancy}-${u.claim}`,{count:x.length,candidates:x})});const R={ideal:"bg-sky-200 text-sky-950 shadow-sky-200/40 hover:bg-sky-300 hover:shadow-sky-300/50",strong:"bg-violet-100 text-violet-900 hover:bg-violet-200",satisfactory:"bg-teal-100 text-teal-900 hover:bg-teal-200",weak:"bg-red-100 text-red-900 hover:bg-red-200",empty:"bg-slate-50 text-slate-300 dark:bg-slate-900 dark:text-slate-600"},S=(u,x,c)=>{const k=u.isNoScore||x.isNoScore,y=u.value??0,h=x.bucket??0;if(k)return"weak";if(c===0)return"empty";const j=h===5&&y===5,L=y===4&&h>=4||y===5&&h===4,T=h>=3&&y>=3;return j?"ideal":L?"strong":T?"satisfactory":"weak"};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"border-b border-border/60 pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Cross Validation Matrix"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Applicant quality matrix: Claim Validity vs Job Fit Score"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[e.jsx($,{className:"rounded-full bg-sky-100 text-sky-800 px-3 py-1",children:"Ideal"}),e.jsx($,{className:"rounded-full bg-violet-100 text-violet-800 px-3 py-1",children:"Strong"}),e.jsx($,{className:"rounded-full bg-teal-100 text-teal-800 px-3 py-1",children:"Satisfactory"}),e.jsx($,{className:"rounded-full bg-red-100 text-red-800 px-3 py-1",children:"Weak"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-10 bg-background px-4 py-2 text-left text-xs font-bold uppercase tracking-wider text-foreground",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{children:"FIT"}),e.jsx("span",{children:"↓"}),e.jsx("span",{children:"CLAIM"}),e.jsx("span",{children:"→"})]})}),l.map(u=>e.jsx("th",{className:"px-4 py-2 text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:u.label},`claim-${u.index}`))]})}),e.jsx("tbody",{children:g.filter(u=>!u.isNoScore).map(u=>e.jsxs("tr",{children:[e.jsx("td",{className:"sticky left-0 z-10 bg-background px-4 py-1 text-left text-xs font-bold text-foreground",children:u.isNoScore?"No Score":`Fit ${u.label}`}),l.map(x=>{const c=`${u.index}-${x.index}`,k=_.get(c),y=k?.candidates?.length??0,j=(a>0?y/a*100:0).toFixed(2),L=u.isNoScore?"Fit No Score":`Fit ${u.label}`,T=x.isNoScore?"Claim No Score":`Claim ${x.label}`,B=S(u,x,y),Y=R[B];return e.jsx("td",{className:"p-0",children:e.jsxs(Tt,{children:[e.jsx(zt,{asChild:!0,children:e.jsxs("button",{className:N("flex h-14 w-full flex-col items-center justify-center border-0 transition-all",Y),"aria-label":`${y} candidates with ${L} and Claim ${T}`,children:[e.jsx("span",{className:"text-base font-bold",children:A(y)}),e.jsxs("span",{className:"text-xs opacity-80",children:[j,"%"]})]})}),y>0&&e.jsx(Bt,{className:"w-80",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-semibold text-foreground",children:[A(y)," Candidates"]}),e.jsxs($,{variant:"outline",className:"text-xs",children:[T," • ",L]})]}),e.jsx(Dt,{className:"h-48",children:e.jsx("div",{className:"space-y-2",children:k?.candidates?.sort((d,w)=>{const C=(w.claim_validity_score??0)-(d.claim_validity_score??0);if(C!==0)return C;const F=(w.relevancy_score??0)-(d.relevancy_score??0);return F!==0?F:d.name.localeCompare(w.name)}).map(d=>e.jsxs("a",{href:`/${s}/recruiter/candidate/${d.id}`,className:"flex items-center justify-between rounded-lg border border-border/60 bg-muted/30 p-2 transition hover:bg-muted cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:N("flex h-6 w-6 items-center justify-center rounded-full text-xs font-semibold",B==="ideal"?"bg-sky-200 text-sky-900":B==="strong"?"bg-violet-100 text-violet-900":B==="satisfactory"?"bg-teal-100 text-teal-900":B==="weak"?"bg-red-100 text-red-900":"bg-slate-100 text-slate-500"),children:d.initials}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:d.name})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[r(d.claim_validity_score),"/5 • ",r(d.relevancy_score),"/5"]})]},d.id))})})]})})]})},c)})]},`rel-${u.index}`))})]})})]})}function X(t,s=1){return Number.isFinite(t)?t.toFixed(s):"0.0"}function Vt({detail:t}){const{totals:s,roi:r}=t,a=r.calculated.time_saved_hours,n=[{title:"Total Applications",value:A(s.applied),caption:"across this posting",icon:Qe},{title:"Diamonds Found",value:A(s.diamonds_found),caption:"high-potential talent",icon:q},{title:"Completion Rate",value:`${t.summary.completion_rate.toFixed(1)}%`,caption:"completed verification",icon:Ye},{title:"Time Efficiency",value:a<1?`${Math.round(a*60)}m`:`${a.toFixed(1)}h`,caption:"saved vs manual",icon:Ke}];return e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:n.map((i,l)=>e.jsxs(H.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:l*.05},className:"rounded-lg border border-border/60 bg-card/95 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"rounded-lg bg-primary/10 p-2 text-primary",children:(()=>{const o=i.icon;return e.jsx(o,{className:"size-4"})})()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:i.title})]}),e.jsx("div",{className:"text-2xl font-semibold text-foreground",children:i.value})]},i.title))})}function Jt({detail:t,tenant:s}){const r=t.diamonds;return r.length?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Diamonds in the Rough"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Top ",r.length," high-potential candidates automatically identified based on Cross Matrix Validation"]})]}),e.jsx("div",{className:"overflow-x-auto overflow-y-hidden -mx-6 px-6 py-2",children:e.jsx("div",{className:"flex gap-4",children:r.map((a,n)=>e.jsxs(H.a,{initial:{opacity:0,y:16},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:n*.05},href:`/${s}/recruiter/candidate/${a.id}`,className:"group min-w-[280px] cursor-pointer overflow-hidden rounded-2xl border border-border/40 bg-card/95 p-5 shadow-sm transition-all duration-200 hover:-translate-y-1 hover:border-brand/20 hover:shadow-lg hover:shadow-brand/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:"/favicon-32x32.png",alt:"Diamond",width:16,height:16,className:"size-4"}),e.jsxs($,{variant:"outline",className:"text-xs font-medium text-gray-700 border-gray-300",children:["#",n+1]})]}),e.jsx("div",{className:"h-8 w-8"})]}),e.jsx("p",{className:"mb-4 text-base font-semibold text-slate-900",children:a.name}),e.jsxs("div",{className:"mb-4 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Claim Validity"}),e.jsxs("span",{className:"font-medium",children:[X(a.claim_validity_score),"/5"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Relevancy"}),e.jsxs("span",{className:"font-medium",children:[X(a.relevancy_score),"/5"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Combined"}),e.jsxs("span",{className:"font-semibold text-gray-700",children:[X(a.combined_score),"/5"]})]})]})]},a.id))})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Diamonds in the Rough"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Top high-potential candidates automatically identified based on Cross Matrix Validation"})]}),e.jsxs("div",{className:"rounded-lg border-dashed border-border/70 bg-muted/40 p-6 text-center",children:[e.jsx(q,{className:"mx-auto size-10 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"No diamonds surfaced yet. Calibrate verification to uncover high-signal candidates."})]})]})}function qt({detail:t}){const s=["No Score","≥0","≥1","≥2","≥3","≥4"],r=t.distributions.claim_validity.slice(0,6).map((l,o)=>({bucket:s[o]??String(o),candidates:l})),a=["≥0","≥1","≥2","≥3","≥4","5"],n=t.distributions.relevancy.slice(1).map((l,o)=>({bucket:a[o]??String(o+1),candidates:l})),i=[{title:"Claim Validity Distribution",data:r,color:"#7dd3fc",stats:t.statistics.claim_validity},{title:"Job Fit Distribution",data:n,color:"#8b5cf6",stats:t.statistics.relevancy}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Score Distributions"}),e.jsx("div",{className:"grid gap-6 grid-cols-1 lg:grid-cols-2",children:i.map(l=>e.jsxs("div",{className:"rounded-lg border border-border/60 bg-card/95 p-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"font-medium text-foreground",children:l.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Mean ",l.stats.mean??"—"," • Median ",l.stats.median??"—"," • σ ",l.stats.std_dev??"—"]}),e.jsx("p",{className:"text-xs text-muted-foreground/70 italic mt-0.5",children:"Statistics calculated from scored candidates only"})]}),e.jsx("div",{className:"h-48",children:e.jsx(et,{data:l.data,keys:["candidates"],indexBy:"bucket",margin:{top:10,right:20,bottom:40,left:20},padding:.4,colors:[l.color],enableGridY:!1,valueScale:{type:"linear",min:0},label:o=>`${A(Math.round(o.value))}`,labelSkipHeight:12,labelTextColor:"var(--foreground)",valueFormat:o=>`${A(Math.round(o))}`,axisLeft:null,axisBottom:{tickSize:0,tickPadding:8,tickRotation:0},enableLabel:!0,isInteractive:!1,theme:{text:{fontSize:12,fill:"var(--muted-foreground)"}}})})]},l.title))})]})}function ie({detail:t}){const{roi:s}=t;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-left lg:text-right",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"ROI Impact"}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:["$",A(Math.round(s.calculated.cost_saved))]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Saved"})]})]}),e.jsxs(Ft,{type:"multiple",defaultValue:["time-saved","screening-speed","efficiency"],className:"w-full",children:[e.jsxs(O,{value:"time-saved",className:"border border-gray-200 rounded-lg mb-2",children:[e.jsx(V,{className:"px-4 py-3 hover:no-underline",children:e.jsxs("div",{className:"flex w-full flex-col gap-2 text-left sm:flex-row sm:items-center sm:justify-between sm:text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Time Saved"}),e.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[s.calculated.time_saved_hours.toFixed(1),"h"]})]})}),e.jsx(J,{className:"px-4 pb-3",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:"Time saved compared to manual screening process"})})]}),s.calculated.speed_improvement&&e.jsxs(O,{value:"screening-speed",className:"border border-gray-200 rounded-lg mb-2",children:[e.jsx(V,{className:"px-4 py-3 hover:no-underline",children:e.jsxs("div",{className:"flex w-full flex-col gap-2 text-left sm:flex-row sm:items-center sm:justify-between sm:text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Screening Speed"}),e.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[s.calculated.speed_improvement,"×"]})]})}),e.jsx(J,{className:"px-4 pb-3",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:"Speed improvement over traditional screening methods"})})]}),e.jsxs(O,{value:"efficiency",className:"border border-gray-200 rounded-lg mb-2",children:[e.jsx(V,{className:"px-4 py-3 hover:no-underline",children:e.jsxs("div",{className:"flex w-full flex-col gap-2 text-left sm:flex-row sm:items-center sm:justify-between sm:text-right",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Human Review Load"}),e.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[s.calculated.efficiency_percentage,"%"]})]})}),e.jsx(J,{className:"px-4 pb-3",children:e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.variables.diamonds_count,"/",s.variables.total_applicants," candidates reviewed"]})})]})]})]})}function Ht({tenant:t,jobCode:s}){me();const{setSelectedJob:r,setTenant:a}=ee();b.useEffect(()=>(a(t),r(s),()=>r(void 0)),[s,a,r,t]);const{data:n,isLoading:i,isError:l,refetch:o,error:f}=de({queryKey:["analytics-detail",t,s],queryFn:()=>St(s,t),enabled:!!(s&&t),retry:(_,R)=>R instanceof Error&&R.message.includes("404")?!1:_<2}),g=n?.jd?.title||s;return e.jsxs("div",{className:"space-y-0",children:[e.jsx(be,{title:g,subtitle:`${A(n?.summary.total_candidates||0)} total applicants`,breadcrumbLabel:"Analytics",breadcrumbHref:`/${t}/recruiter/analytics`,showBackButton:!1,showRefreshButton:!1,showDateRange:!1,showFilters:!1}),e.jsxs("section",{className:"bg-white p-6",children:[l?e.jsxs(M,{className:"rounded-3xl border-destructive/60 bg-destructive/10 p-6",children:[e.jsx(W,{className:"p-0",children:e.jsx(Q,{className:"text-base text-destructive",children:"Unable to load analytics detail"})}),e.jsxs(P,{className:"mt-2 space-y-3 p-0 text-sm text-destructive/80",children:[e.jsx("p",{children:f instanceof Error&&f.message.includes("404")?"No analytics found for this job code in the selected tenant.":`Check that analytics_service.py is running and reachable at ${Z.analyticsBaseUrl}.`}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>o(),className:"hover:bg-[#F2F1EE] cursor-pointer",children:"Retry"})]})]}):null,i?e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{className:"h-32 rounded-2xl"}),e.jsx(I,{className:"h-64 rounded-2xl"}),e.jsx(I,{className:"h-64 rounded-2xl"})]}):null,!n||i?null:e.jsxs("div",{className:"space-y-0",children:[e.jsx("div",{className:"border-b border-gray-200 pb-6",children:e.jsx(Vt,{detail:n})}),e.jsx("div",{className:"border-b border-gray-200 py-6",children:e.jsx(Jt,{detail:n,tenant:t})}),e.jsx("div",{className:"border-b border-gray-200 py-6",children:e.jsx(Ot,{detail:n,tenant:t})}),e.jsx("div",{className:"border-b border-gray-200 py-6",children:e.jsx(qt,{detail:n})}),e.jsx("div",{className:"border-b border-gray-200 py-6",children:e.jsxs("div",{className:"grid gap-8 grid-cols-1 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx($t,{data:n.completion_funnel||[],completionRate:n.summary?.completion_rate||0})}),e.jsx("div",{className:"hidden lg:block lg:col-span-1",children:e.jsx("div",{className:"h-full border-l border-gray-200 pl-8",children:e.jsx(ie,{detail:n})})})]})}),e.jsx("div",{className:"lg:hidden py-6",children:e.jsx(ie,{detail:n})})]})]})]})}function Wt(){const s=ue().pathname.split("/").filter(Boolean);if(s.length>=3&&s[0]&&s[1]==="recruiter"&&s[2]==="analytics"){const r=s[0];if(s.length===3)return e.jsx(re,{tenant:r,children:e.jsx(Lt,{tenant:r})});if(s.length===4){const a=s[3];return e.jsx(re,{tenant:r,children:e.jsx(Ht,{tenant:r,jobCode:a})})}}return e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-foreground",style:{fontFamily:"var(--font-heading), var(--font-sans)"},children:"Analytics Dashboard"}),e.jsx("p",{children:"Invalid route. Please navigate to /tenant/recruiter/analytics"})]})}const Qt=new Te({defaultOptions:{queries:{staleTime:60*1e3,retry:!1}}});rt.createRoot(document.getElementById("root")).render(e.jsx(Ie.StrictMode,{children:e.jsxs(ze,{client:Qt,children:[e.jsx(De,{children:e.jsx(Wt,{})}),e.jsx(at,{initialIsOpen:!1})]})}));
